<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>CONSIDERACIONES PARA RESOLVER LOS EJERCICIOS DE PASAJE DE MENSAJES ASINCR&Oacute;NICO &lpar;PMA&rpar;&colon;</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only],
.vscode-high-contrast:not(.vscode-high-contrast-light) img[src$=\#gh-light-mode-only],
.vscode-high-contrast-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

</style>
            
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-light">
            <h4 id="consideraciones-para-resolver-los-ejercicios-de-pasaje-de-mensajes-asincrónico-pma">CONSIDERACIONES PARA RESOLVER LOS EJERCICIOS DE PASAJE DE MENSAJES ASINCRÓNICO (PMA):</h4>
<p>• Los canales son compartidos por todos los procesos.</p>
<p>• Cada canal es una cola de mensajes; por lo tanto, el primer mensaje encolado es el primero en ser atendido.</p>
<p>• Por ser PMA, el send no bloquea al emisor.</p>
<p>• Se puede usar la sentencia empty para saber si hay algún mensaje en el canal, pero no se puede consultar por la cantidad de mensajes encolados.</p>
<p>• Se puede utilizar el if/do no determinístico donde cada opción es una condición boolena donde se puede preguntar por variables locales y/o por empty de canales.</p>
<pre><code>    if (cond 1) -&gt; Acciones 1;
    (cond 2) -&gt; Acciones 2;
    ….
    (cond N) -&gt; Acciones N;
    end if
</code></pre>
<p>De todas las opciones cuya condición sea Verdadera elige una en forma no determinística y ejecuta las acciones correspondientes. Si ninguna es verdadera, sale del if/do sin ejecutar acción alguna.</p>
<p>• Se debe evitar hacer busy waiting siempre que sea posible (sólo hacerlo si no hay otra opción).</p>
<p>• En todos los ejercicios el tiempo debe representarse con la función delay</p>
<hr>
<h2 id="1">1</h2>
<p>Suponga que N clientes llegan a la cola de un banco y que serán atendidos por sus empleados. Analice el problema y defina qué procesos, recursos y canales/comunicaciones serán necesarios/convenientes para resolverlo. Luego, resuelva considerando las siguientes situaciones:</p>
<p>a. Existe un único empleado, el cual atiende por orden de llegada.</p>
<p>b. Ídem a) pero considerando que hay 2 empleados para atender, ¿qué debe modificarse en la solución anterior?</p>
<p>c. Ídem b) pero considerando que, si no hay clientes para atender, los empleados realizan tareas administrativas durante 15 minutos. ¿Se puede resolver sin usar procesos adicionales? ¿Qué consecuencias implicaría?</p>
<h2 id="a">A</h2>
<pre><code class="language-c">chan <span class="hljs-title function_">consultas</span><span class="hljs-params">(<span class="hljs-built_in">string</span>,<span class="hljs-type">int</span>)</span>;
chan respuestas[<span class="hljs-number">1.</span>.N](<span class="hljs-built_in">string</span>);

Process Cliente[id:<span class="hljs-number">1.</span>.N]{
    <span class="hljs-built_in">string</span> consulta = ...
    <span class="hljs-built_in">string</span> respuesta;
    consultas.send(consulta,id)
    respuestas[id].receive(respuesta)
}
Process Empleado{
    <span class="hljs-built_in">string</span> consulta;
    <span class="hljs-type">int</span> id;
    <span class="hljs-built_in">string</span> respuesta;
    <span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>{
        consultas.receive(consulta,id);
        <span class="hljs-comment">//Genera respuesta</span>
        respuestas[id].send(respuesta)
    }
}
</code></pre>
<h2 id="b">B</h2>
<pre><code class="language-c">chan <span class="hljs-title function_">consultas</span><span class="hljs-params">(<span class="hljs-built_in">string</span>,<span class="hljs-type">int</span>)</span>;
chan respuestas[<span class="hljs-number">1.</span>.N](<span class="hljs-built_in">string</span>);

Process Cliente[id:<span class="hljs-number">1.</span>.N]{
    <span class="hljs-built_in">string</span> consulta = ...
    <span class="hljs-built_in">string</span> respuesta;
    consultas.send(consulta,id)
    respuestas[id].receive(respuesta)
}
Process Empleado[<span class="hljs-number">1.</span><span class="hljs-number">.2</span>]{
    <span class="hljs-built_in">string</span> consulta;
    <span class="hljs-type">int</span> id;
    <span class="hljs-built_in">string</span> respuesta;
    <span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>{
        consultas.receive(consulta,id);
        <span class="hljs-comment">//Genera respuesta</span>
        respuestas[id].send(respuesta)
    }
}
</code></pre>
<h2 id="c">C</h2>
<pre><code class="language-c">chan <span class="hljs-title function_">consultas</span><span class="hljs-params">(<span class="hljs-built_in">string</span>,<span class="hljs-type">int</span>)</span>;
chan respuestas[<span class="hljs-number">1.</span>.N](<span class="hljs-built_in">string</span>);

Process Cliente[id:<span class="hljs-number">1.</span>.N]{
    <span class="hljs-built_in">string</span> consulta = ...
    <span class="hljs-built_in">string</span> respuesta;
    consultas.send(consulta,id)
    respuestas[id].receive(respuesta)
}
Process Empleado[<span class="hljs-number">1.</span><span class="hljs-number">.2</span>]{
    <span class="hljs-built_in">string</span> consulta;
    <span class="hljs-type">int</span> id;
    <span class="hljs-built_in">string</span> respuesta;
    <span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>{
        <span class="hljs-keyword">if</span> (!empty(consultas)){
            consultas.receive(consulta,id)
            <span class="hljs-comment">//Genera respuesta</span>
            respuestas[id].send(respuesta)
        }
        (empty(consultas)){
            <span class="hljs-comment">//Trabajo administratiivo</span>
            delay(<span class="hljs-number">15</span>)
        }
        end <span class="hljs-keyword">if</span>
    }
}
</code></pre>
<h2 id="2">2</h2>
<p>Se desea modelar el funcionamiento de un banco en el cual existen 5 cajas para realizar pagos. Existen P clientes que desean hacer un pago. Para esto, cada una selecciona la caja donde hay menos personas esperando; una vez seleccionada, espera a ser atendido. En cada caja, los clientes son atendidos por orden de llegada por los cajeros. Luego del pago, se les entrega un comprobante. Nota: maximizar la concurrencia.</p>
<pre><code class="language-C">chan caja[<span class="hljs-number">1.</span><span class="hljs-number">.5</span>](<span class="hljs-built_in">string</span>,<span class="hljs-type">int</span>)
chan <span class="hljs-title function_">espera</span><span class="hljs-params">(<span class="hljs-type">int</span>)</span>
chan cajaAsignada[1..P]<span class="hljs-params">(<span class="hljs-type">int</span>)</span>
chan respyesta[1..P]<span class="hljs-params">(<span class="hljs-built_in">string</span>)</span>
chan <span class="hljs-title function_">avisoAtencion</span><span class="hljs-params">(<span class="hljs-type">int</span>)</span>

Process Administrador{
    <span class="hljs-type">int</span> cant[<span class="hljs-number">1.</span><span class="hljs-number">.5</span>]=<span class="hljs-number">0</span>
    <span class="hljs-type">int</span> total=<span class="hljs-number">0</span>
    <span class="hljs-type">int</span> id
    <span class="hljs-type">int</span> caja
    <span class="hljs-keyword">while</span> total &lt; P{
            <span class="hljs-keyword">if</span> (avistoAtencion.isEmpty() AND !espera.isEmpty()){
                espera.receive(id)
                i = cant.getMinIndice()
                cajaAsignada[id].send(i)
                cant[i]++
                total++
            }
            (!avisotAtencion.isEmpty()){
                avistoAtencion.receive(caja)
                cant[caja]--
            }
            end <span class="hljs-keyword">if</span>
        }
}

Process Caja[id=<span class="hljs-number">1.</span><span class="hljs-number">.5</span>]{
    <span class="hljs-type">int</span> numeroCliente
    <span class="hljs-built_in">string</span> datosPago
    <span class="hljs-built_in">string</span> comprobante
    <span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>{
        caja[id].receive(datosPago,numeroCliente)
        avistoAtencion.send(id)
        <span class="hljs-comment">//Procesa la transaccion</span>
        respuesta[numeroCliente].send(comprobante)
    }
}

Process Cliente[id:<span class="hljs-number">1.</span>.P]{
    <span class="hljs-type">int</span> numero_caja
    <span class="hljs-built_in">string</span> consulta=..
    <span class="hljs-built_in">string</span> datosPago=..
    <span class="hljs-built_in">string</span> comprobante
    espera.send(id)
    cajaAsignada[id].receive(numero_caja)
    caja[numero_caja].send(datosPago,id)
    respuesta[id].receive(comprobante)
}
</code></pre>

            
            
        </body>
        </html>